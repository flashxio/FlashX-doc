<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Weighted Covariance Matrices</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for cov.wt"><tr><td>cov.wt</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Weighted Covariance Matrices</h2>

<h3>Description</h3>

<p>Returns a list containing estimates of the weighted covariance
matrix and the mean of the data, and optionally of the (weighted)
correlation matrix.
</p>


<h3>Usage</h3>

<pre>
## S4 method for signature 'fm'
cov.wt(x, wt = rep(1/nrow(x), nrow(x)), cor = FALSE,
  center = TRUE, method = c("unbiased", "ML"))
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>a matrix. As usual, rows are observations and columns are variables.</p>
</td></tr>
<tr valign="top"><td><code>wt</code></td>
<td>
<p>a non-negative and non-zero vector of weights for each
observation.  Its length must equal the number of rows of
<code>x</code>.</p>
</td></tr>
<tr valign="top"><td><code>cor</code></td>
<td>
<p>a logical indicating whether the estimated correlation
weighted matrix will be returned as well.</p>
</td></tr>
<tr valign="top"><td><code>center</code></td>
<td>
<p>either a logical or a numeric vector specifying the centers
to be used when computing covariances.  If <code>TRUE</code>, the
(weighted) mean of each variable is used, if <code>FALSE</code>, zero is
used.  If <code>center</code> is numeric, its length must equal the
number of columns of <code>x</code>.</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p>string specifying how the result is scaled, see <code>Details</code>
below. Can be abbreviated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, <code>method = "unbiased"</code>, The covariance matrix is
divided by one minus the sum of squares of the weights, so if the
weights are the default (1/n) the conventional unbiased estimate
of the covariance matrix with divisor (n - 1) is obtained.  This
differs from the behaviour in S-PLUS which corresponds to <code>method
= "ML"</code> and does not divide.
</p>


<h3>Value</h3>

<p>A list containing the following named components:
</p>

<ul>
<li><p>covthe estimated (weighted) covariance matrix.
</p>
</li>
<li><p>centeran estimate for the center (mean) of the data.
</p>
</li>
<li><p>n.obsthe number of observations (rows) in <code>x</code>.
</p>
</li>
<li><p>wtthe weights used in the estimation.  Only returned if given
as an argument.
</p>
</li>
<li><p>corthe estimated correlation matrix.  Only returned if <code>cor</code> is
<code>TRUE</code>
</p>
</li></ul>



<h3>Examples</h3>

<pre>
mat &lt;- fm.runif.matrix(100, 10)
cov.wt(mat, fm.runif(nrow(mat)))
</pre>


</body></html>
